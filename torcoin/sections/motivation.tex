\section{Motivation and Related Works} \label{motivation} Solving the problem of
compensating Tor relays is attractive because it would immediately improve the
scalability of the Tor network. Prior research has not arrived at a satisfactory
solution that operates within the basic requirements of an incentive scheme. We
now outline those requirements.

\subsection{Requirements of an Incentive System} At a basic level, an incentive
system must retain anonymity but have the ability to verifiably measure
bandwidth and reliably distribute payment to the nodes that provide it. The
system must be resilient to adversaries attempting to  identify clients, or fake
bandwidth transfer.

\subsubsection{Anonymity-Preserving Architecture} TorCoin should preserve
anonymity. Currently, no Tor client can recognize another, and no relay can
identify the source or destination of any packet it transfers. Proposed
incentive schemes like Tortoise\cite{acsac11-tortoise} and Gold Star\cite
{incentives-fc10} have compromised clients' anonymity by allowing their traffic
to be identified\cite{jansen2013lira}. In a proportionally differentiated
service \cite{blake1998architecture, dovrolis1999case} like LIRA
\cite{jansen2013lira} a speed-monitoring adversary can potentially partition the
anonymity set into clients that are paying for higher speeds, thus reducing
anonymity. An acceptable implementation of TorCoin will at least retain the
anonymity of the current Tor protocol, but an excellent one will improve upon
it.

\subsubsection{Verifiable Bandwidth Accounting} TorCoin needs to measure
bandwidth in such a way that anyone can verify its measurements. Optimally, it
will not require self-reporting or centralized servers, unlike EigenSpeed
\cite{snader2009eigenspeed} or Opportunistic Bandwidth Monitoring
\cite{snader2008tune}. The system should be robust to attackers or groups of
attackers colluding to misreport bandwidth measurements, and the entire network 
should agree on all measurements. Rather than relying on reported network
speeds, TorCoin uses an onion-hashing scheme to push ``TorCoin Packets'' through
the circuit to measure its end-to-end throughput.

\subsubsection{Anonymity Preserving Payment Distribution} Once TorCoin measures
the bandwidth of a given node, it must distribute payment to that node in a way
that preserves anonymity. Specifically, it should not be possible for anyone to
associate a bandwidth payment or measurement with a specific relay. Since
TorCoin also requires verifiable accounting, the problem becomes how to verify
bandwidth without identifying its provider.

\subsubsection{Highly-Available, Reliable Transaction Storage} TorCoin must
store sufficient records of previous payments to avoid rewarding a relay twice
for the same bandwidth transfer. Other proposed Tor incentive schemes like
LIRA\cite{jansen2013lira} use a trusted central bank to assign coins and track
spending. This makes the entire incentive scheme dependent on the central
authority. Instead, TorCoin uses the BitCoin protocol's distributed ledger to
track transactions and avoid double spending\cite{karame2012two}. There is no
central authority in-charge of the incentive system.

\subsubsection{Scalable and Deployable with Minimal Code Changes} To simplify
deployability, TorCoin should operate mostly as a wrapper around the existing
Tor clients. It should require minimal changes to the core Tor codebase, and
should not significantly increase latency of requests. A good incentive scheme
should also be scalable to accommodate a large number of users and relays
operating concurrently. Unlike schemes like BRAIDS \cite{ccs10-braids}, TorCoin
is designed to be scalable because of its decentralized structure, small
transaction overheads and use of protocols like Bitcoin to implement some
features.

\subsection{Key Technical Challenges}

We might envision a naive bandwidth-measurement scheme using blinded
cryptographic tokens to signify bandwidth transfer. Suppose in this scheme, a
client is able to give each relay a token for the amount of bandwidth it
provides. Relays are then able to convert these client-signed tokens into some
form of an incentive.  Such a scheme would be vulnerable to colluding groups of
clients and relays, however, who can simply sign each other's transfer tokens
without actually transferring any bandwidth.

We attempt to counter this through the TorPath scheme, which restricts clients'
ability to choose their own path, ensuring that {\em most} paths include at
least one non-colluding participant (the client or at least one of the three
relays). Assignment servers bundle large groups of clients and relays into {\em
groups} that collectively choose paths. Even in the relatively rare event that a
path constructed this way consists entirely of colluding clients and relays, an
upper bound on the number of coins each path can mint rate-limits potential loss
to such entirely-colluding paths.