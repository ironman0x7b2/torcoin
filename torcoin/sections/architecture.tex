\section{Proposed Architecture} \label{arch}

\subsection{Overview}

TorCoin runs as a standalone service, and requires very little modification of
the core Tor codebase. The system can be broken into four components, which
share code across clients and relays, but behave differently depending on
role. Figure 3.1 shows a basic overview of their architecture.

\begin{figure}
  \centering
    \includegraphics[scale=0.3]{architecture.pdf}
  \caption{High level TorCoin system architecture. Note that a ``trusted node''
  replaces a directory server, and actually improves on its anonymity properties.}
\end{figure}

We briefly describe the architecture of the system here. Then, the
next section will describe the detailed implementations of the TorPath
protocol and TorCoin algorithm.

TorPath is an anonymous cooperative routing scheme that randomly assigns
circuits to Tor clients using decentralized, cryptographically verifiable
methods. It consists of groups of assignment servers, which are ``trusted'' in
the same way as Tor directory servers, and a TorPath client to communicate
with them.  Groups of assignment servers use the distributed TorPath protocol
to  keep track of available relays and assign circuits to clients.

The TorCoin algorithm is used to reward nodes for transferring bandwidth. It
consists  of a TorCoin miner and a TorCoin Wallet. The TorCoin miner measures
Tor bandwidth by monitoring the  throughput of the local Tor TLS tunnel,
allowing us to avoid modifying internal  Tor code. It also sends out TorCoin
packets that serve as ``proof-of-bandwidth''. The TorCoin Wallet is a
cryptographic wallet for storage of coins and transactions. When the miner
discovers a new TorCoin, it adds it to the blockchain with all the information
necessary fro anyone to verify it.

% Original text:
% \subsection{TorPath Components} TorPath is an anonymous cooperative routing
% scheme that randomly assigns circuits to Tor clients using decentralized,
% cryptographically verifiable methods. It requires groups of assignment servers,
% which are ``trusted'' in the same way as Tor directory servers, and a TorPath
% client to communicate with them. 

% \subsubsection{Assignment Server} A small set of trusted nodes run the
% Assignment Servers, which perform similar roles to the current Tor directory 
% servers. Groups of assignment servers use the distributed TorPath protocol to 
% keep track of available relays and assign circuits to clients.

% \subsubsection{TorPath Software} Clients and relays install the TorPath Software to
% communicate with Assignment Servers, using the TorPath protocol to retrieve
% circuits (clients). 
% % To avoid modifying Tor client code, TorPath can use a local 
% % DNS proxy to redirect requests to directory servers to the new assignment servers.

% \subsection{TorCoin Components} These components implement the TorCoin algorithm
% in order to reward nodes for transferring bandwidth. We describe the TorCoin 
% algorithm in depth in its own section, so here we only briefly outline the 
% components required to implement it.

% \subsubsection{TorCoin Miner} To mine TorCoins, clients and relays that are part
% of a circuit communicate via the TorCoin miner, which implements the TorCoin
% algorithm. The TorCoin miner measures Tor bandwidth by monitoring the the 
% throughput of the local Tor TLS tunnel, allowing us to avoid modifying internal 
% Tor code.

% \subsubsection{TorCoin Wallet} Since TorCoin is based on the BitCoin protocol,
% it uses a cryptographic wallet for storage of coins and transactions. When the
% miner discovers a new TorCoin, it adds it to the blockchain with all the
% information necessary fro anyone to verify it.